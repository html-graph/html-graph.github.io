<!doctype html>
<html>
  <head>
    <title>HTMLGraph | Force-directed layout demo</title>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <style>
      html,
      body {
        height: 100%;
        padding: 0;
        margin: 0;
      }

      body {
        position: relative;
        font-family: Arial, sans-serif;
      }

      #canvas {
        position: absolute;
        inset: 0;
      }

      .node {
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        width: 100px;
        height: 100px;
        background: #daedbd;
        border: 1px solid #9e9e9e;
        box-shadow: 0 0 5px #9e9e9e;
        border-radius: 50%;
        user-select: none;
      }
    </style>
  </head>
  <body>
    <div id="graph" style="display: none">
      {
        "nodes": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36],
        "edges": [
          { "from": 0, "to": 1 },
          { "from": 1, "to": 2 },
          { "from": 2, "to": 0 },
          { "from": 2, "to": 3 },
          { "from": 1, "to": 3 },
          { "from": 2, "to": 4 },
          { "from": 3, "to": 4 },
          { "from": 1, "to": 5 },
          { "from": 3, "to": 5 },
          { "from": 3, "to": 6 },
          { "from": 3, "to": 7 },
          { "from": 4, "to": 6 },
          { "from": 6, "to": 7 },
          { "from": 5, "to": 7 },
          { "from": 5, "to": 8 },
          { "from": 7, "to": 8 },
          { "from": 6, "to": 9 },
          { "from": 4, "to": 9 },
          { "from": 7, "to": 10 },
          { "from": 8, "to": 10 },
          { "from": 5, "to": 11 },
          { "from": 8, "to": 11 },
          { "from": 5, "to": 12 },
          { "from": 1, "to": 12 },
          { "from": 11, "to": 12 },
          { "from": 1, "to": 13 },
          { "from": 0, "to": 13 },
          { "from": 13, "to": 12 },
          { "from": 7, "to": 14 },
          { "from": 6, "to": 14 },
          { "from": 10, "to": 14 },
          { "from": 6, "to": 15 },
          { "from": 14, "to": 15 },
          { "from": 9, "to": 15 },
          { "from": 9, "to": 16 },
          { "from": 4, "to": 16 },
          { "from": 4, "to": 17 },
          { "from": 2, "to": 17 },
          { "from": 16, "to": 17 },
          { "from": 2, "to": 18 },
          { "from": 0, "to": 18 },
          { "from": 17, "to": 18 },
          { "from": 18, "to": 19 },
          { "from": 0, "to": 19 },
          { "from": 0, "to": 21 },
          { "from": 19, "to": 21 },
          { "from": 13, "to": 21 },
          { "from": 13, "to": 22 },
          { "from": 21, "to": 22 },
          { "from": 13, "to": 23 },
          { "from": 12, "to": 23 },
          { "from": 22, "to": 23 },
          { "from": 12, "to": 24 },
          { "from": 11, "to": 24 },
          { "from": 23, "to": 24 },
          { "from": 25, "to": 11 },
          { "from": 26, "to": 11 },
          { "from": 25, "to": 26 },
          { "from": 24, "to": 25 },
          { "from": 8, "to": 26 },
          { "from": 8, "to": 27 },
          { "from": 10, "to": 27 },
          { "from": 26, "to": 27 },
          { "from": 27, "to": 28 },
          { "from": 10, "to": 28 },
          { "from": 10, "to": 29 },
          { "from": 14, "to": 29 },
          { "from": 28, "to": 29 },
          { "from": 30, "to": 14 },
          { "from": 30, "to": 29 },
          { "from": 30, "to": 15 },
          { "from": 31, "to": 15 },
          { "from": 31, "to": 30 },
          { "from": 31, "to": 20 },
          { "from": 20, "to": 15 },
          { "from": 20, "to": 9 },
          { "from": 31, "to": 20 },
          { "from": 32, "to": 9 },
          { "from": 32, "to": 20 },
          { "from": 32, "to": 16 },
          { "from": 33, "to": 32 },
          { "from": 33, "to": 16 },
          { "from": 34, "to": 16 },
          { "from": 34, "to": 17 },
          { "from": 35, "to": 17 },
          { "from": 35, "to": 18 },
          { "from": 36, "to": 18 },
          { "from": 36, "to": 19 },
          { "from": 33, "to": 34 },
          { "from": 34, "to": 35 },
          { "from": 35, "to": 36 }
        ]
      }
    </div>
    <div id="canvas"></div>
    <script type="module">
      import { CanvasBuilder } from "https://unpkg.com/@html-graph/html-graph@8.0.0";

      class Application {
        constructor(element) {
          this.canvas = new CanvasBuilder(element)
            .setDefaults({
              nodes: {
                priority: 1,
              },
              edges: {
                shape: {
                  type: "direct",
                  sourceOffset: 50,
                  targetOffset: 50,
                },
                priority: 0,
              },
            })
            .enableUserDraggableNodes({ moveEdgesOnTop: false })
            .enableUserTransformableViewport()
            .enableBackground()
            .enableLayout()
            .build();
        }

        initGraph(graphData) {
          graphData.nodes.forEach((nodeId) => {
            const element = document.createElement("div");
            element.classList.add("node");
            element.innerText = `${nodeId}`;

            this.canvas.addNode({
              id: nodeId,
              element,
              ports: [
                {
                  id: nodeId,
                  element,
                },
              ],
            });
          });

          graphData.edges.forEach((edge) => {
            this.canvas.addEdge({ from: edge.from, to: edge.to });
          });

          this.canvas.patchViewportMatrix({ scale: 2.5 })
        }
      }

      const element = document.getElementById("canvas");
      const app = new Application(element);

      const graphContent = document.getElementById("graph");
      const graph = JSON.parse(graphContent.innerText);

      app.initGraph(graph);
    </script>
  </body>
</html>
