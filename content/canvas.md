---
title: Canvas
---

## Canvas

The `Canvas` API provides a set of methods and properties for managing graph visualization.

`Canvas` uses a fluent interface, allowing methods to be chained for concise configuration. For example:

{{< code lang="javascript" >}}
const element = document.getElementById('canvas');

const canvas = new CanvasBuilder(element).build();

canvas
  .addNode({ x: 100, y: 100, element: document.createElement('div') })
  .addNode({ x: 200, y: 200, element: document.createElement('div') })
  .addNode({ x: 300, y: 300, element: document.createElement('div') });
{{< /code >}}

Below is a list of all available methods

---

### Add Node [#](#add-node) ### {#add-node}

Adds a node to the canvas.

{{< code lang="javascript">}}
canvas.addNode({
  id: "node-1",
  x: 100,
  y: 100,
  element: document.createElement('div'),
});
{{< /code >}}

For convenience, ports can be specified directly during node creation.

{{< code lang="javascript">}}
const node = document.createElement('div');
const port = document.createElement('div');
node.appendChild(port);

canvas.addNode({
  id: "node-1",
  element: node,
  x: 100,
  y: 100,
  ports: [
    {
      id: "port-1",
      element: port,
    },
  ],
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
const node = document.createElement('div');
const port = document.createElement('div');
node.appendChild(port);

canvas.addNode({
  id: "node-1",
  element: node,
  x: 100,
  y: 100,
  ports: [
    {
      id: "port-1",
      element: port,
      direction: 0,
    },
  ],
  centerFn: (w, h) => ({ x: w / 2, y: h / 2 }),
  priority: 1,
});
{{< /code >}}

#### Parameters

| Name       | Type                                                | Description                             | Required | Default                        |
|------------|-----------------------------------------------------|-----------------------------------------|----------|--------------------------------|
| `id`       | `any`                                               | Unique identifier for the node          | no       | _autogenerated_                |
| `element`  | `HTMLElement`                                       | HTML element for the node               | yes      |                                |
| `x`        | `number \| null`                                    | X-coordinate of the node                | no       | `null`                         |
| `y`        | `number \| null`                                    | Y-coordinate of the node                | no       | `null`                         |
| `ports`    | <code>Array\<[Port](#add-node-port-params)\></code> | Array of ports                          | no       | `[]`                           |
| `centerFn` | `function`                                          | Function to determine the node's center | no       | `(w, h) => ({x: w/2, y: h/2})` |
| `priority` | `number`                                            | Z-index of the node                     | no       | `0`                            |

<b>\* Only nodes with defined coordinates are actually displayed on the canvas.
When using `null` coordinates, make sure to update them later using a <a href="/layouts/">layout algorithm</a>
or an <a href="/animated-layouts/">animated layout algorithm</a>.</b>

{{< ref-target ref="add-node-port-params">}}

#### Port Parameters #### {#add-node-port-params}

| Name        | Type          | Description                        | Required | Default         |
|-------------|---------------|------------------------------------|----------|-----------------|
| `id`        | `any`         | Unique identifier for the port     | no       | _autogenerated_ |
| `element`   | `HTMLElement` | HTML element for the port          | yes      |                 |
| `direction` | `number`      | Radian angle for edge direction    | no       | `0`             |

{{< /ref-target >}}

---

### Update Node [#](#update-node) ### {#update-node}

Updates specified properties of a node.

{{< code lang="javascript">}}
canvas.updateNode("node-1", {
  x: 100,
  y: 100,
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
canvas.updateNode("node-1", {
  x: 100,
  y: 100,
  priority: 10,
  centerFn: () => ({ x: 0, y: 0 }),
});
{{< /code >}}

When called without parameters, the coordinates of all edges connected to the node will be updated.

{{< code lang="javascript">}}
canvas.updateNode("node-1");
{{< /code >}}

#### Parameters for `updateNode`:

| Name            | Type                                                   | Description                      | Required | Default |
|-----------------|--------------------------------------------------------|----------------------------------|----------|---------|
| `id`            | `any`                                                  | Identifier of the node to update | yes      |         |
| `updateRequest` | <code>[NodeUpdateRequest](#node-update-request)</code> | Properties to update             | no       | `{}`    |

{{< ref-target ref="node-update-request">}}
#### `NodeUpdateRequest` Parameters #### {#node-update-request}

| Name       | Type       | Description                             | Required |
|------------|------------|-----------------------------------------|----------|
| `x`        | `number`   | X-coordinate of the node                | no       |
| `y`        | `number`   | Y-coordinate of the node                | no       |
| `priority` | `number`   | Z-index of the node                     | no       |
| `centerFn` | `function` | Function to determine the node's center | no       |
{{< /ref-target >}}

---

### Remove Node [#](#remove-node) ### {#remove-node}

Removes a specified node from the canvas. All associated ports will be unmarked, and any edges connected to the node will also be removed.

{{< code lang="javascript">}}
canvas.removeNode("node-1");
{{< /code >}}

#### Parameters for `removeNode`: ####

| Name | Type  | Description                      | Required |
|------|-------|----------------------------------|----------|
| `id` | `any` | Identifier of the node to remove | yes      |

---

### Mark Port [#](#mark-port) ### {#mark-port}

Marks an element as a port for a specific node.

{{< code lang="javascript">}}
const portElement = document.createElement('div');

nodeElement.appendChild(portElement);

canvas.markPort({
  nodeId: "node-1",
  element: portElement,
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
canvas.markPort({
  id: "port-1",
  nodeId: "node-1",
  element: portElement,
  direction: -Math.PI,
});
{{< /code >}}

#### Parameters for `markPort`: ####

| Name        | Type          | Description                     | Required | Default         |
|-------------|---------------|---------------------------------|----------|-----------------|
| `id`        | `any`         | Unique identifier for the port  | no       | _autogenerated_ |
| `nodeId`    | `any`         | Identifier of the node          | yes      |                 |
| `element`   | `HTMLElement` | HTML element for the port       | yes      |                 |
| `direction` | `number`      | Radian angle for edge direction | no       | `0`             |

Static ports can also be defined directly within the [addNode](/canvas/#add-node) method.

---

### Update Port [#](#update-port) ### {#update-port}

Updates specified properties of a port.

{{< code lang="javascript">}}
canvas.updatePort("port-1", {
  direction: -Math.PI,
});
{{< /code >}}

When called without parameters, the coordinates of all edges connected to the port will be updated.

{{< code lang="javascript">}}
canvas.updatePort("port-1");
{{< /code >}}

#### Parameters for `updatePort`:

| Name            | Type                                                   | Description                      | Required | Default |
|-----------------|--------------------------------------------------------|----------------------------------|----------|---------|
| `id`            | `any`                                                  | Identifier of the port to update | yes      |         |
| `updateRequest` | <code>[PortUpdateRequest](#port-update-request)</code> | Properties to update             | no       | `{}`    |

{{< ref-target ref="port-update-request">}}
#### `PortUpdateRequest` Parameters #### {#port-update-request}

| Name        | Type     | Description                     | Required |
|-------------|----------|---------------------------------|----------|
| `direction` | `number` | Radian angle for edge direction | no       |
{{< /ref-target >}}

---

### Unmark Port [#](#unmark-port) ### {#unmark-port}

Unmarks a specified port, removing relation to the node. All edges connected to the port will also be removed.

{{< code lang="javascript">}}
canvas.unmarkPort("port-1");
{{< /code >}}

#### Parameters for `unmarkPort`:

| Name | Type   | Description                      | Required |
|------|--------|----------------------------------|----------|
| `id` | `any`  | Identifier of the port to unmark | yes      |

---

### Add Edge [#](#add-edge) ### {#add-edge}

Adds an edge between two ports on the canvas.

{{< code lang="javascript">}}
canvas.addEdge({
  from: "port-1",
  to: "port-2",
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
import { BezierEdgeShape } from "@html-graph/html-graph";

canvas.addEdge({
  id: "edge-1",
  from: "port-1",
  to: "port-2",
  shape: new BezierEdgeShape(),
  priority: 5,
});
{{< /code >}}

#### Parameters:

| Name       | Type                                                               | Description                    | Required | Default           |
|------------|--------------------------------------------------------------------|--------------------------------|----------|-------------------|
| `id`       | `any`                                                              | Unique identifier for the edge | no       | _autogenerated_   |
| `from`     | `any`                                                              | Identifier of the source port  | yes      |                   |
| `to`       | `any`                                                              | Identifier of the target port  | yes      |                   |
| `shape`    | <code><a href="/edge-shapes/" target="_blank">EdgeShape</a></code> | Shape of the edge              | no       | `BezierEdgeShape` |
| `priority` | `number`                                                           | Z-index of the edge            | no       | `0`               |

---

### Update Edge [#](#update-edge) ### {#update-edge}

Updates specified properties of an edge.

{{< code lang="javascript">}}
canvas.updateEdge("edge-1", {
  from: "port-3",
  to: "port-4",
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
canvas.updateEdge("edge-1", {
  from: "port-3",
  to: "port-4",
  shape: new HorizontalEdgeShape(),
  priority: 10,
});
{{< /code >}}

When called without parameters, the edge's coordinates will be recalculated.

{{< code lang="javascript">}}
canvas.updateEdge("edge-1");
{{< /code >}}

#### Parameters for `updateEdge`:

| Name            | Type                                                              | Description                      | Required | Default |
|-----------------|-------------------------------------------------------------------|----------------------------------|----------|---------|
| `id`            | `any`                                                             | Identifier of the edge to update | yes      |         |
| `updateRequest` | <code><a href="#edge-update-request">EdgeUpdateRequest</a></code> | Properties to update             | no       | `{}`    |

{{< ref-target ref="edge-update-request">}}
#### `EdgeUpdateRequest` Parameters #### {#edge-update-request}

| Name       | Type                                                               | Description               | Required |
|------------|--------------------------------------------------------------------|---------------------------|----------|
| `from`     | `any`                                                              | Identifier of source port | no       |
| `to`       | `any`                                                              | Identifier of target port | no       |
| `shape`    | <code><a href="/edge-shapes/" target="_blank">EdgeShape</a></code> | Edge shape                | no       |
| `priority` | `number`                                                           | Z-index of the edge       | no       |
{{< /ref-target >}}

---

### Remove Edge [#](#remove-edge) ### {#remove-edge}

Removes a specified edge from the canvas.

{{< code lang="javascript">}}
canvas.removeEdge("edge-1");
{{< /code >}}

#### Parameters for `removeEdge`:

| Name | Type  | Description                      | Required |
|------|-------|----------------------------------|----------|
| `id` | `any` | Identifier of the edge to remove | yes      |

---

### Clear [#](#clear) ### {#clear}

Removes all nodes and edges from the canvas, allowing it to be reused.

{{< code lang="javascript">}}
canvas.clear();
{{< /code >}}

---

### Destroy [#](#destroy) ### {#destroy}

Destroys the canvas. The provided HTML element gets rolled back to its initial state. Once this method is called, the canvas cannot be reused.

{{< code lang="javascript" >}}
canvas.destroy();
{{< /code >}}

---

### Patch Viewport Matrix (advanced) [#](#patch-viewport-matrix) ### {#patch-viewport-matrix}

The viewport transformation matrix consists of three values: `scale`, `x`, and `y`.

- **Scale**: Represents the current scaling factor of the viewport. Increasing the scale expands the viewport itself, thereby making objects appear smaller, while decreasing the scale shrinks the viewport, causing objects to appear larger.
- **X**: Measures the horizontal distance from the absolute zero point to the top-left corner of the viewport on the canvas.
- **Y**: Measures the vertical distance from the absolute zero point to the top-left corner of the viewport on the canvas.

To better understand how these values work, experiment with the demo below.

{{< use-case src=/use-cases/viewport-matrix/ >}}

To update the viewport matrix values, use the `patchViewportMatrix` method. All parameters are optional.

{{< code lang="javascript">}}
canvas.patchViewportMatrix({
  scale: 0.5,
  x: -50,
  y: -50,
});
{{< /code >}}

This matrix is the inverse of the [content matrix](/canvas/#patch-content-matrix).

---

### Patch Content Matrix (advanced) [#](#patch-content-matrix) ### {#patch-content-matrix}

The content transformation matrix consists of three values: `scale`, `x`, and `y`.

- **Scale**: Represents the current scaling factor of the content. A larger scale amplifies the size of the content, making it appear bigger, while a smaller scale reduces its visual size, creating a zoomed-out appearance.
- **X**: Measures the horizontal distance from the top-left corner of the viewport to the absolute zero point on the screen.
- **Y**: Measures the vertical distance from the top-left corner of the viewport to the absolute zero point on the screen.

To better understand how these values work, experiment with the demo below.

{{< use-case src=/use-cases/content-matrix/ >}}

To update the content matrix values, use the `patchContentMatrix` method. All parameters are optional.

{{< code lang="javascript">}}
canvas.patchContentMatrix({
  scale: 2,
  x: 100,
  y: 100,
});
{{< /code >}}

This matrix is the inverse of the [viewport matrix](/canvas/#patch-viewport-matrix).
