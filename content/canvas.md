---
title: Canvas
---

## Canvas

The `Canvas` API provides a set of methods and properties for managing graph visualization.

`Canvas` uses a fluent interface, allowing methods to be chained for concise configuration. For example:

{{< code lang="javascript" >}}
const element = document.getElementById('canvas');

const canvas = new CanvasBuilder(element).build();

canvas
  .addNode({ x: 100, y: 100, element: document.createElement('div') })
  .addNode({ x: 200, y: 200, element: document.createElement('div') })
  .addNode({ x: 300, y: 300, element: document.createElement('div') })
  .patchViewportMatrix({ x: -100, y: -100 });
{{< /code >}}

Below is a list of all available methods

---

### Add Node ### {#add-node}

Adds a node to the canvas with customizable properties.

{{< code lang="javascript">}}
canvas.addNode({
  id: "node-1",
  x: 100,
  y: 100,
  element: document.createElement('div'),
});
{{< /code >}}

For convenience, static ports can be defined directly during node creation.

{{< code lang="javascript">}}
const node = document.createElement('div');
const port = document.createElement('div');
node.appendChild(port);

canvas.addNode({
  id: "node-1",
  element: node,
  x: 100,
  y: 100,
  ports: [
    {
      id: "port-1",
      element: port,
    },
  ],
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
const node = document.createElement('div');
const port = document.createElement('div');
node.appendChild(port);

canvas.addNode({
  id: "node-1",
  element: node,
  x: 100,
  y: 100,
  ports: [
    {
      id: "port-1",
      element: port,
      direction: 0,
    },
  ],
  centerFn: (w, h) => ({ x: w / 2, y: h / 2 }),
  priority: 1,
});
{{< /code >}}

#### Parameters

| Name     | Type                                   | Description                             | Required   | Default                        |
|----------|----------------------------------------|-----------------------------------------|------------|--------------------------------|
| id       | any                                    | Unique identifier for the node          | no         | _autogenerated_                |
| element  | HTMLElement                            | HTML element for the node               | yes        |                                |
| x        | number                                 | X-coordinate of the node                | yes        |                                |
| y        | number                                 | Y-coordinate of the node                | yes        |                                |
| ports    | Array\<[Port](#add-node-port-params)\> | Array of ports                          | no         | `[]`                           |
| centerFn | function                               | Function to determine the node's center | no         | `(w, h) => ({x: w/2, y: h/2})` |
| priority | number                                 | Z-index of the node                     | no         | `0`                            |

{{< ref-target ref="add-node-port-params">}}

#### Port Parameters #### {#add-node-port-params}

| Name      | Type        | Description                        | Required | Default         |
|-----------|-------------|------------------------------------|----------|-----------------|
| id        | any         | Unique identifier for the port     | no       | _autogenerated_ |
| element   | HTMLElement | HTML element for the port          | yes      |                 |
| direction | number      | Radian angle for edge direction    | no       | `0`             |

{{< /ref-target >}}

---

### Update Node ### {#update-node}

Updates specified properties of a node.

{{< code lang="javascript">}}
canvas.updateNode("node-1", {
  x: 100,
  y: 100,
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
canvas.updateNode("node-1", {
  x: 100,
  y: 100,
  priority: 10,
  centerFn: () => ({ x: 0, y: 0 }),
});
{{< /code >}}

When called without parameters, the coordinates of all edges connected to the node will be updated.

{{< code lang="javascript">}}
canvas.updateNode("node-1");
{{< /code >}}

#### Parameters for `updateNode`:

| Name          | Type                                      | Description                      | Required | Default |
|---------------|-------------------------------------------|----------------------------------|----------|---------|
| id            | any                                       | Identifier of the node to update | yes      |         |
| updateRequest | [NodeUpdateRequest](#node-update-request) | Properties to update             | no       | `{}`    |

{{< ref-target ref="node-update-request">}}
#### `NodeUpdateRequest` Parameters #### {#node-update-request}

| Name     | Type     | Description                             | Required |
|----------|----------|-----------------------------------------|----------|
| x        | number   | X-coordinate of the node                | no       |
| y        | number   | Y-coordinate of the node                | no       |
| priority | number   | Z-index of the node                     | no       |
| centerFn | function | Function to determine the node's center | no       |
{{< /ref-target >}}

---

### Remove Node ### {#remove-node}

Removes a specified node from the canvas. All associated ports will be unmarked, and any edges connected to the node will also be removed.

{{< code lang="javascript">}}
canvas.removeNode("node-1");
{{< /code >}}

#### Parameters for `removeNode`: ####

| Name | Type | Description                      | Required |
|------|------|----------------------------------|----------|
| id   | any  | Identifier of the node to remove | yes      |

---

### Mark Port ### {#mark-port}

Marks an element as a port for a specific node.

{{< code lang="javascript">}}
const portElement = document.createElement('div');

nodeElement.appendChild(portElement);

canvas.markPort({
  nodeId: "node-1",
  element: portElement,
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
canvas.markPort({
  id: "port-1",
  nodeId: "node-1",
  element: portElement,
  direction: -Math.PI,
});
{{< /code >}}

#### Parameters for `markPort`: ####

| Name      | Type        | Description                     | Required | Default         |
|-----------|-------------|---------------------------------|----------|-----------------|
| id        | any         | Unique identifier for the port  | no       | _autogenerated_ |
| nodeId    | any         | Identifier of the node          | yes      |                 |
| element   | HTMLElement | HTML element for the port       | yes      |                 |
| direction | number      | Radian angle for edge direction | no       | `0`             |

Static ports can also be defined directly within the [addNode](/canvas/#add-node) method.

---

### Update Port ### {#update-port}

Updates specified properties of a port.

{{< code lang="javascript">}}
canvas.updatePort("port-1", {
  direction: -Math.PI,
});
{{< /code >}}

When called without parameters, the coordinates of all edges connected to the port will be updated.

{{< code lang="javascript">}}
canvas.updatePort("port-1");
{{< /code >}}

#### Parameters for `updatePort`:

| Name          | Type                                      | Description                      | Required | Default |
|---------------|-------------------------------------------|----------------------------------|----------|---------|
| id            | any                                       | Identifier of the port to update | yes      |         |
| updateRequest | [PortUpdateRequest](#port-update-request) | Properties to update             | no       | `{}`    |

{{< ref-target ref="port-update-request">}}
#### `PortUpdateRequest` Parameters #### {#port-update-request}

| Name      | Type   | Description                     | Required |
|-----------|--------|---------------------------------|----------|
| direction | number | Radian angle for edge direction | no       |
{{< /ref-target >}}

---

### Unmark Port ### {#unmark-port}

Unmarks a specified port, removing relation to the node. All edges connected to the port will also be removed.

{{< code lang="javascript">}}
canvas.unmarkPort("port-1");
{{< /code >}}

#### Parameters for `unmarkPort`:

| Name | Type | Description                      | Required |
|------|------|----------------------------------|----------|
| id   | any  | Identifier of the port to unmark | yes      |

---

### Add Edge ### {#add-edge}

Adds an edge between two ports on the canvas.

{{< code lang="javascript">}}
canvas.addEdge({
  id: "edge-1",
  from: "port-1",
  to: "port-2",
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
import { BezierEdgeShape } from "@html-graph/html-graph";

canvas.addEdge({
  id: "edge-1",
  from: "port-1",
  to: "port-2",
  shape: new BezierEdgeShape(),
  priority: 5,
});
{{< /code >}}

#### Parameters:

| Name     | Type                     | Description                    | Required | Default           |
|----------|--------------------------|--------------------------------|----------|-------------------|
| id       | any                      | Unique identifier for the edge | no       | _autogenerated_   |
| from     | any                      | Identifier of the source port  | yes      |                   |
| to       | any                      | Identifier of the target port  | yes      |                   |
| shape    | [EdgeShape](/edge-shape) | Shape of the edge              | no       | `BezierEdgeShape` |
| priority | number                   | Z-index of the edge            | no       | `0`               |

---

### Update Edge ### {#update-edge}

Updates specified properties of an edge.

{{< code lang="javascript">}}
canvas.updateEdge("edge-1", {
  from: "port-3",
  to: "port-4",
});
{{< /code >}}

All available parameters are demonstrated in the following example:

{{< code lang="javascript">}}
canvas.updateEdge("edge-1", {
  from: "port-3",
  to: "port-4",
  shape: new HorizontalEdgeShape(),
  priority: 10,
});
{{< /code >}}

When called without parameters, the edge's coordinates will be recalculated.

{{< code lang="javascript">}}
canvas.updateEdge("edge-1");
{{< /code >}}

#### Parameters for `updateEdge`:

| Name          | Type                                      | Description                      | Required | Default |
|---------------|-------------------------------------------|----------------------------------|----------|---------|
| id            | any                                       | Identifier of the edge to update | yes      |         |
| updateRequest | [EdgeUpdateRequest](#edge-update-request) | Properties to update             | no       | `{}`    |

{{< ref-target ref="edge-update-request">}}
#### `EdgeUpdateRequest` Parameters #### {#edge-update-request}

| Name     | Type                     | Description               | Required |
|----------|--------------------------|---------------------------|----------|
| from     | any                      | Identifier of source port | no       |
| to       | any                      | Identifier of target port | no       |
| shape    | [EdgeShape](/edge-shape) | Edge shape                | no       |
| priority | number                   | Z-index of the edge       | no       |
{{< /ref-target >}}

---

### Remove Edge ### {#remove-edge}

Removes a specified edge from the canvas.

{{< code lang="javascript">}}
canvas.removeEdge("edge-1");
{{< /code >}}

#### Parameters for `removeEdge`:

| Name | Type | Description                      | Required |
|------|------|----------------------------------|----------|
| id   | any  | Identifier of the edge to remove | yes      |

---

### Clear ### {#clear}

Removes all nodes and edges from the canvas, allowing it to be reused.

{{< code lang="javascript">}}
canvas.clear();
{{< /code >}}

---

### Destroy ### {#destroy}

Destroys the canvas. The provided HTML element gets rolled back to its initial state. Once this method is called, the canvas cannot be reused.

{{< code lang="javascript" >}}
canvas.destroy();
{{< /code >}}

---

### Patch Viewport Matrix ### {#patch-viewport-matrix}

The viewport transformation matrix consists of three values: `scale`, `x`, and `y`.

- **Scale**: Represents the current scaling factor of the viewport. A larger scale zooms out, making the content appear smaller, while a smaller scale zooms in, making the content appear larger.
- **X**: The horizontal distance from the absolute zero point to the top-left corner of the viewport.
- **Y**: The vertical distance from the absolute zero point to the top-left corner of the viewport.

To better understand how these values work, experiment with the demo below.

{{< use-case title="Viewport Matrix" src=/use-cases/viewport-matrix/ >}}

To update the viewport matrix values, use the `patchViewportMatrix` method. All parameters are optional.

{{< code lang="javascript">}}
canvas.patchViewportMatrix({
  scale: 0.5,
  x: -50,
  y: -50,
});
{{< /code >}}

This matrix is the inverse of the [content matrix](/canvas/#patch-content-matrix).

---

### Patch Content Matrix ### {#patch-content-matrix}

The content transformation matrix consists of three values: `scale`, `x`, and `y`.

- **Scale**: Represents the current scaling factor of the content. A larger scale makes the content appear bigger, while a smaller scale zooms out, making the content appear smaller.
- **X**: The horizontal distance from the top-left corner of the viewport to the absolute zero point.
- **Y**: The vertical distance from the top-left corner of the viewport to the absolute zero point.

To better understand how these values work, experiment with the demo below.

{{< use-case title="Content Matrix" src=/use-cases/content-matrix/ >}}

To update the content matrix values, use the `patchContentMatrix` method. All parameters are optional.

{{< code lang="javascript">}}
canvas.patchContentMatrix({
  scale: 2,
  x: 100,
  y: 100,
});
{{< /code >}}

This matrix is the inverse of the [viewport matrix](/canvas/#patch-viewport-matrix).
